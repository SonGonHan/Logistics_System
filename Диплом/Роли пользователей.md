#диплом
## Неавторизованный контакт (UNREGISTERED_CONTACT)

- Автоматическое создание: оператор ПВЗ при оформлении накладной вводит телефон получателя; если пользователь с таким номером не найден, система автоматически создает запись с role_name='UNREGISTERED_CONTACT', без пароля и email.
    
- Отслеживание посылки: получение информации о статусе накладной через публичный API без авторизации — достаточно указать номер накладной и телефон получателя; уведомления приходят по SMS с ссылкой на трекинг.
    
- Получение посылки: оператор ПВЗ или курьер сверяет документ получателя (паспорт) с данными в накладной (ФИО, телефон) и выдает посылку после успешной идентификации.
    
- Оплата при получении: если плательщик — получатель, оплачивает посылку на точке или курьеру картой/наличными; оператор/курьер принимает оплату с фиксацией суммы и выдает чек.
    
- Переход в CLIENT: при регистрации в системе роль меняется на 'CLIENT', добавляются пароль и email, сохраняется вся история посылок, привязанных к номеру телефона, открывается доступ к личному кабинету.
    
- Ограничения доступа: не может создавать черновики накладных, управлять профилем, настраивать уведомления, оставлять отзывы или использовать любые авторизованные функции системы до регистрации.

## Клиент (CLIENT)
 
- Черновик накладной: ввод адреса назначения, контакта получателя, габаритов/веса, выбор ПВЗ, предварительная калькуляция и сохранение черновика с штрихкодом для быстрой сдачи.
    
- Управление черновиком: редактирование и отмена до сдачи, необязательное бронирование окна сдачи на ПВЗ, просмотр инструкций и сроков действия.
    
- Отслеживание и история: просмотр статусов “Принято в ПВЗ/На складе/В пути/Доставлено”, получение уведомлений, доступ к истории отправлений.
    
- Обратная связь: оставление оценки и отзыва после доставки, получение персонализированных уведомлений.
    

## Оператор ПВЗ (PVZ_OPERATOR)

- Приемка по черновику: поиск по штрихкоду/ID, техпроверка (взвешивание, измерения, фотофиксация), пересчет стоимости и сроков, подтверждение условий.
    
- Подтверждение и оформление: конвертация черновика в оформленную накладную, печать ярлыка/квитанции, фиксация статуса “Принято в ПВЗ”.
    
- Приемка без черновика: создание черновика по информации клиента, техпроверка, пересчет стоимости и оформление после согласия клиента.
    
- Оплата на ПВЗ: прием оплаты отправителя или получателя на точке — картой/наличными; при наличных фиксируются суммы “получено” и “сдано”, печатаются чеки; до выдачи может корректировать метод оплаты в пределах лимитов.
    
- Оформление без оплаты: если плательщик — получатель, устанавливает признак “ожидает оплаты при выдаче (ПВЗ/курьер)” и завершает оформление без взимания средств.
    
- Допуслуги: дополнительная упаковка/страхование до финального подтверждения с фиксацией в системе и чеке.
    
- Операции точки: поиск/обработка отправлений, отмена на точке по регламенту, передача заказа курьеру, базовые инвентарные сверки.
    

## Администратор ПВЗ (PVZ_ADMIN)

- Управление операциями: подтверждение спорных операций, корректировка статусов в исключениях, контроль SLA точки, выборочные повторные взвешивания и качество приемки.
    
- Кассовые решения: утверждает сторно/возвраты, решает кассовые расхождения, подтверждает корректировки суммы/метода сверх лимитов оператора и закрывает спорные случаи.
    
- Персонал и отчеты: управление доступами и ролями на ПВЗ, просмотр отчетов и аудит действий сотрудников точки.
    

## Оператор склада (WAREHOUSE_OPERATOR)

- Приемка на складе: регистрация поступления, привязка мест к заказам, размещение по ячейкам со сканированием.
    
- Комплектация и погрузка: сбор под отгрузку, маркировка, подтверждение погрузки сканами, фиксация выезда.
    

## Менеджер склада (WAREHOUSE_MANAGER)

- Планирование и диспетчирование: назначение слотов, транспорта и сменных заданий, распределение операторов по зонам.
    
- Контроль качества и инвентаря: акцепт критичных операций, разбор расхождений, закрытие смен, отчётность и SLA склада.
    

## Курьер (COURIER)

- Доставка: получение назначений и маршрута ПВЗ–Дом, старт рейса, передача GPS‑координат, фиксация промежуточных статусов.
    
- Оплата у двери: если плательщик — получатель и оплачено=false, принимает оплату картой (мобильный эквайринг) или наличными с фиксацией “получено/сдано”; выдача запрещена до успешной оплаты; при невозможности оплаты — завершает как неудачную попытку с указанием причины.
    
- Завершение: подтверждение вручения с подписью/фото/ПИН или регистрация неудачной попытки и инициирование последующих действий по регламенту.
    

## Водитель (DRIVER)

- Магистральные/складские рейсы: получение плана рейса Склад–ПВЗ/Склад–Склад, фиксация прибытия/готовности к погрузке, сканирование мест.
    
- Завершение: фиксация выезда, прибытия, разгрузки и закрытие рейса с метриками времени и километража.
    

## Диспетчер/Планировщик (DISPATCHER)

- Назначения: распределение задач курьерам/водителям, перераспределение при отклонениях, контроль выполнения.
    
- Координация: взаимодействие с маршрутизацией и трекингом для обновления ETA и статусов, работа с инцидентами доставки.
    

## Сотрудник HR (HR)

- Кадровые операции: создание сотрудников, изменение должностей/статусов, увольнение, синхронизация ролей доступа.
    
- Контроль: аудит кадровых действий и поддержание актуальной ролевой модели в системе.
    

## Бухгалтер (ACCOUNTANT)

- Начисления и выплаты: управление зарплатами/ведомостями, статусы выплат исполнителям и сотрудникам.
    
- Отчётность и касса: формирование финансовых и операционных отчётов по периодам и подразделениям; приём кассовых отчётов ПВЗ и курьеров (Z‑отчёты, инкассация), контроль возвратов и инициирование корректировок по регламенту.
    

## Системный администратор платформы (ADMIN)

- Платформа и безопасность: управление пользователями/ролями, конфигурацией сервисов, лимитами и политиками безопасности на edge‑слое.
    
- Наблюдаемость и аварийные операции: доступ к журналам, настройкам маршрутизации, метрикам и механизмам безопасного отключения интеграций.